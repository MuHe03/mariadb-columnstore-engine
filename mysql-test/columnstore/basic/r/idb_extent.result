DROP DATABASE IF EXISTS idb_extent_test_db;
CREATE DATABASE idb_extent_test_db;
USE idb_extent_test_db;
create table t1 (
col_signed TINYINT,
col_unsigned TINYINT UNSIGNED,
col_small_signed SMALLINT,
col_small_unsigned SMALLINT UNSIGNED,
col_med_signed MEDIUMINT,
col_med_unsigned MEDIUMINT UNSIGNED,
col_int_signed INT,
col_int_unsigned INT UNSIGNED,
col_big_signed BIGINT,
col_big_unsigned BIGINT UNSIGNED,
col_dec_signed DECIMAL(38,0),
col_dec_unsigned DECIMAL(38,0) UNSIGNED
)engine=columnstore;
INSERT INTO t1 (col_signed) VALUES(-126);
INSERT INTO t1 (col_signed) VALUES(127);
INSERT INTO t1 (col_unsigned) VALUES(0);
INSERT INTO t1 (col_unsigned) VALUES(253);
INSERT INTO t1 (col_small_signed) VALUES(-32766);
INSERT INTO t1 (col_small_signed) VALUES(32767);
INSERT INTO t1 (col_small_unsigned) VALUES(0);
INSERT INTO t1 (col_small_unsigned) VALUES(65533);
INSERT INTO t1 (col_med_signed) VALUES(-8388608);
INSERT INTO t1 (col_med_signed) VALUES(8388607);
INSERT INTO t1 (col_med_unsigned) VALUES(0);
INSERT INTO t1 (col_med_unsigned) VALUES(16777215);
INSERT INTO t1 (col_int_signed) VALUES(-2147483646);
INSERT INTO t1 (col_int_signed) VALUES(2147483647);
INSERT INTO t1 (col_int_unsigned) VALUES(0);
INSERT INTO t1 (col_int_unsigned) VALUES(4294967293);
INSERT INTO t1 (col_big_signed) VALUES(-9223372036854775806);
INSERT INTO t1 (col_big_signed) VALUES(9223372036854775807);
INSERT INTO t1 (col_big_unsigned) VALUES(0);
INSERT INTO t1 (col_big_unsigned) VALUES(18446744073709551613);
INSERT INTO t1 (col_dec_signed) VALUES(-70000000000000000000000000000000000003);
INSERT INTO t1 (col_dec_signed) VALUES(80000000000000000000000000000000000003);
INSERT INTO t1 (col_dec_unsigned) VALUES(0);
INSERT INTO t1 (col_dec_unsigned) VALUES(70000000000000000000000000000000000003);
SELECT count(idbextentmax(col_signed)), count(idbextentmin(col_signed)),
count(idbextentmax(col_unsigned)), count(idbextentmin(col_unsigned)),
count(idbextentmax(col_small_signed)), count(idbextentmin(col_small_signed)),
count(idbextentmax(col_small_unsigned)), count(idbextentmin(col_small_unsigned)),
count(idbextentmax(col_med_signed)), count(idbextentmin(col_med_signed)),
count(idbextentmax(col_med_unsigned)), count(idbextentmin(col_med_unsigned)),
count(idbextentmax(col_int_signed)), count(idbextentmin(col_int_signed)),
count(idbextentmax(col_int_unsigned)), count(idbextentmin(col_int_unsigned))
#       count(idbextentmax(col_big_signed)), count(idbextentmin(col_big_signed)),
#       count(idbextentmax(col_big_unsigned)), count(idbextentmin(col_big_unsigned)),
#       count(idbextentmax(col_dec_signed)), count(idbextentmin(col_dec_signed)),
#       count(idbextentmax(col_dec_unsigned)), count(idbextentmin(col_dec_unsigned))
FROM t1 LIMIT 1;
count(idbextentmax(col_signed))	count(idbextentmin(col_signed))	count(idbextentmax(col_unsigned))	count(idbextentmin(col_unsigned))	count(idbextentmax(col_small_signed))	count(idbextentmin(col_small_signed))	count(idbextentmax(col_small_unsigned))	count(idbextentmin(col_small_unsigned))	count(idbextentmax(col_med_signed))	count(idbextentmin(col_med_signed))	count(idbextentmax(col_med_unsigned))	count(idbextentmin(col_med_unsigned))	count(idbextentmax(col_int_signed))	count(idbextentmin(col_int_signed))	count(idbextentmax(col_int_unsigned))	count(idbextentmin(col_int_unsigned))
0	0	0	0	0	0	0	0	0	0	0	0	0	0	0	0
SELECT 'q1', idbextentmax(col_signed), idbextentmin(col_signed) FROM t1 LIMIT 1;
q1	idbextentmax(col_signed)	idbextentmin(col_signed)
q1	NULL	NULL
SELECT 'q2', idbextentmax(col_unsigned), idbextentmin(col_unsigned) FROM t1 LIMIT 1;
q2	idbextentmax(col_unsigned)	idbextentmin(col_unsigned)
q2	NULL	NULL
SELECT 'q3', idbextentmax(col_small_signed), idbextentmin(col_small_signed) FROM t1 LIMIT 1;
q3	idbextentmax(col_small_signed)	idbextentmin(col_small_signed)
q3	NULL	NULL
SELECT 'q4', idbextentmax(col_small_unsigned), idbextentmin(col_small_unsigned) FROM t1 LIMIT 1;
q4	idbextentmax(col_small_unsigned)	idbextentmin(col_small_unsigned)
q4	NULL	NULL
SELECT 'q5', idbextentmax(col_med_signed), idbextentmin(col_med_signed) FROM t1 LIMIT 1;
q5	idbextentmax(col_med_signed)	idbextentmin(col_med_signed)
q5	NULL	NULL
SELECT 'q6', idbextentmax(col_med_unsigned), idbextentmin(col_med_unsigned) FROM t1 LIMIT 1;
q6	idbextentmax(col_med_unsigned)	idbextentmin(col_med_unsigned)
q6	NULL	NULL
SELECT 'q7', idbextentmax(col_int_signed), idbextentmin(col_int_signed) FROM t1 LIMIT 1;
q7	idbextentmax(col_int_signed)	idbextentmin(col_int_signed)
q7	2147483647	-2147483646
SELECT 'q8', idbextentmax(col_int_unsigned), idbextentmin(col_int_unsigned) FROM t1 LIMIT 1;
q8	idbextentmax(col_int_unsigned)	idbextentmin(col_int_unsigned)
q8	NULL	NULL
DROP DATABASE idb_extent_test_db;
