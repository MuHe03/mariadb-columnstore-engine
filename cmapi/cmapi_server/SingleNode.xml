<?xml version="1.0"?>
<Columnstore Version="V1.0.0">
<!--
	WARNING: Do not make changes to this file unless directed to do so by
	MariaDB service engineers. Incorrect settings can render your system
	unusable and will require a service call to correct.
-->
	<ExeMgr1>
		<IPAddr>127.0.0.1</IPAddr>
		<Port>8601</Port>
		<Module>unassigned</Module>
	</ExeMgr1>
	<pm1_WriteEngineServer>
		<IPAddr>127.0.0.1</IPAddr>
		<Port>8630</Port>
	</pm1_WriteEngineServer>
	<DDLProc>
		<IPAddr>127.0.0.1</IPAddr>
		<Port>8612</Port>
	</DDLProc>
	<DMLProc>
		<IPAddr>127.0.0.1</IPAddr>
		<Port>8614</Port>
	</DMLProc>
	<BatchInsert>
		<RowsPerBatch>10000</RowsPerBatch>
	</BatchInsert>
	<PrimitiveServers>
		<Count>1</Count>
		<ConnectionsPerPrimProc>2</ConnectionsPerPrimProc>
		<ProcessorThreshold>128</ProcessorThreshold>
		<ProcessorQueueSize>10K</ProcessorQueueSize> <!-- minimum of extent size 8192 -->
		<DebugLevel>0</DebugLevel>
		<LBID_Shift>13</LBID_Shift>
		<ColScanBufferSizeBlocks>512</ColScanBufferSizeBlocks>
		<ColScanReadAheadBlocks>512</ColScanReadAheadBlocks> <!-- s/b factor of extent size 8192 -->
		<!-- <BPPCount>16</BPPCount> --> <!-- Default num cores * 2.  A cap on the number of simultaneous primitives per jobstep -->
		<PrefetchThreshold>1</PrefetchThreshold>
		<PTTrace>0</PTTrace>
		<RotatingDestination>n</RotatingDestination> <!-- Iterate thru UM ports; set to 'n' if UM/PM on same server -->
		<!-- <HighPriorityPercentage>60</HighPriorityPercentage> -->
		<!-- <MediumPriorityPercentage>30</MediumPriorityPercentage> -->
		<!-- <LowPriorityPercentage>10</LowPriorityPercentage> -->
		<DirectIO>y</DirectIO>
        <HighPriorityPercentage/>
        <MediumPriorityPercentage/>
        <LowPriorityPercentage/>
	</PrimitiveServers>
	<PMS1>
		<IPAddr>127.0.0.1</IPAddr>
		<Port>8620</Port>
	</PMS1>
	<SystemConfig>
		<SystemName>columnstore-1</SystemName>
		<ParentOAMModuleName>pm1</ParentOAMModuleName>
		<StandbyOAMModuleName>unassigned</StandbyOAMModuleName>
		<PrimaryUMModuleName>pm1</PrimaryUMModuleName>
		<ModuleHeartbeatPeriod>1</ModuleHeartbeatPeriod>
		<ModuleHeartbeatCount>3</ModuleHeartbeatCount>
		<ModuleProcMonWaitCount>12</ModuleProcMonWaitCount>	// 2.5 minutes
		<!-- Disabled
		<ProcessHeartbeatPeriod>-1</ProcessHeartbeatPeriod>
		-->
		<!-- Warning: Do not change this value once database is built -->
		<DBRootCount>1</DBRootCount>
        <DBRoot1>/var/lib/columnstore/data1</DBRoot1>
        <DBRMRoot>/var/lib/columnstore/data1/systemFiles/dbrm/BRM_saves</DBRMRoot>
        <TableLockSaveFile>/var/lib/columnstore/data1/systemFiles/dbrm/tablelocks</TableLockSaveFile>
		<DBRMTimeOut>15</DBRMTimeOut> <!-- in seconds -->
		<DBRMSnapshotInterval>100000</DBRMSnapshotInterval>
		<ExternalCriticalThreshold>90</ExternalCriticalThreshold>
		<ExternalMajorThreshold>80</ExternalMajorThreshold>
		<ExternalMinorThreshold>70</ExternalMinorThreshold>
		<!-- <TempDiskPath>/tmp</TempDiskPath>
		<WorkingDir>/tmp</WorkingDir>
		<TempFileDir>/tmp/columnstore_tmp_files</TempFileDir>
		-->
		<TransactionArchivePeriod>10</TransactionArchivePeriod>
		<NMSIPAddress>0.0.0.0</NMSIPAddress>
		<TempSaveSize>128M</TempSaveSize> <!-- default SWSDL max element save size -->
		<WaitPeriod>10</WaitPeriod> <!-- in seconds -->
		<ProcessRestartCount>10</ProcessRestartCount>
		<ProcessRestartPeriod>120</ProcessRestartPeriod>
		<SwapAction>restartSystem</SwapAction>	<!-- OAM command (or 'none') to run when swap space exceeds Major Threshold -->
		<ActivePmFailoverDisabled>n</ActivePmFailoverDisabled>
		<MemoryCheckPercent>95</MemoryCheckPercent> <!-- Max real memory to limit growth of buffers to -->
		<DataFileLog>OFF</DataFileLog>
		<!-- enable if you want to limit how much memory may be used for hdfs read/write memory buffers.
 		<hdfsRdwrBufferMaxSize>8G</hdfsRdwrBufferMaxSize>
		-->
 		<hdfsRdwrScratch>/rdwrscratch</hdfsRdwrScratch> <!-- Do not set to an hdfs file path -->
 		<TempFileDir>/columnstore_tmp_files</TempFileDir>
 		<SystemTempFileDir>/tmp/columnstore_tmp_files</SystemTempFileDir>
	</SystemConfig>
	<SystemModuleConfig>
		<ModuleType3>pm</ModuleType3>
		<ModuleDesc3>Performance Module</ModuleDesc3>
		<RunType3>SIMPLEX</RunType3>
		<ModuleCount3>1</ModuleCount3>
		<ModuleIPAddr1-1-3>127.0.0.1</ModuleIPAddr1-1-3>
		<ModuleHostName1-1-3>localhost</ModuleHostName1-1-3>
		<ModuleDisableState1-3>ENABLED</ModuleDisableState1-3>
		<ModuleDBRootCount1-3>1</ModuleDBRootCount1-3>
		<ModuleDBRootID1-1-3>1</ModuleDBRootID1-1-3>
	</SystemModuleConfig>
	<SessionManager>
		<MaxConcurrentTransactions>1000</MaxConcurrentTransactions>
        <TxnIDFile>/var/lib/columnstore/data1/systemFiles/dbrm/SMTxnID</TxnIDFile>
	</SessionManager>
	<VersionBuffer>
		<!-- VersionBufferFileSize must be a multiple of 8192.
		One version buffer file will be put on each DB root. -->
		<VersionBufferFileSize>1GB</VersionBufferFileSize>
	</VersionBuffer>
	<OIDManager>
		<!-- Do not change this file after database built	 -->
        <OIDBitmapFile>/var/lib/columnstore/data1/systemFiles/dbrm/oidbitmap</OIDBitmapFile>
		<!-- Do not change this value after database built	 -->
		<FirstOID>3000</FirstOID>
	</OIDManager>
	<WriteEngine>
        <BulkRoot>/var/lib/columnstore/data/bulk</BulkRoot>
        <BulkRollbackDir>/var/lib/columnstore/data1/systemFiles/bulkRollback</BulkRollbackDir>
		<MaxFileSystemDiskUsagePct>98</MaxFileSystemDiskUsagePct>
		<CompressedPaddingBlocks>1</CompressedPaddingBlocks> <!-- Number of blocks used to pad compressed chunks -->
	</WriteEngine>
	<DBRM_Controller>
		<NumWorkers>1</NumWorkers>
		<IPAddr>127.0.0.1</IPAddr>
		<Port>8616</Port>
	</DBRM_Controller>
	<!-- Worker Port: 8700 - 8720 is reserved to support External Modules-->
	<DBRM_Worker1>
		<IPAddr>127.0.0.1</IPAddr>
		<Port>8700</Port>
		<Module>pm1</Module>
	</DBRM_Worker1>
	<DBBC>
		<!-- The percentage of RAM to use for the disk block cache. Defaults to 70% -->
        <!-- Alternatively, this can be specified in absolute terms using
             the suffixes 'm' or 'g' to denote size in megabytes or gigabytes.-->
		<!-- <NumBlocksPct>95</NumBlocksPct> -->
		<!-- <NumThreads>16</NumThreads> --> <!-- 1-256.  Default is 16. -->
		<NumCaches>1</NumCaches><!-- # of parallel caches to instantiate -->
		<IOMTracing>0</IOMTracing>
		<BRPTracing>0</BRPTracing>
		<ReportFrequency>65536</ReportFrequency>
		<MaxOpenFiles>2K</MaxOpenFiles>
		<DecreaseOpenFilesCount>200</DecreaseOpenFilesCount>
		<FDCacheTrace>0</FDCacheTrace>
		<NumBlocksPct>50</NumBlocksPct>
	</DBBC>
	<Installation>
		<SystemStartupOffline>n</SystemStartupOffline>
		<InitialInstallFlag>y</InitialInstallFlag>
		<SingleServerInstall>y</SingleServerInstall>
		<ServerTypeInstall>2</ServerTypeInstall>
		<PMwithUM>y</PMwithUM>
		<MySQLRep>n</MySQLRep>
		<DBRootStorageType>internal</DBRootStorageType>
		<UMStorageType>internal</UMStorageType>
		<EEPackageType>binary</EEPackageType>
		<SystemLogConfigFile>/etc/rsyslog.d/columnstore.conf</SystemLogConfigFile>
		<Cloud>unassigned</Cloud>
		<AmazonVPCNextPrivateIP>autoassign</AmazonVPCNextPrivateIP>
		<UMInstanceType>unassigned</UMInstanceType>
		<UMSecurityGroup>unassigned</UMSecurityGroup>
		<UMVolumeSize>unassigned</UMVolumeSize>
		<UMVolumeType>gp2</UMVolumeType>
		<UMVolumeIOPS>unassigned</UMVolumeIOPS>
		<PMInstanceType>unassigned</PMInstanceType>
		<PMVolumeSize>unassigned</PMVolumeSize>
		<PMVolumeType>gp2</PMVolumeType>
		<PMVolumeIOPS>unassigned</PMVolumeIOPS>
		<AmazonPMFailover>y</AmazonPMFailover>
		<AmazonAutoTagging>y</AmazonAutoTagging>
		<AmazonElasticIPCount>0</AmazonElasticIPCount>
		<AmazonElasticIPAddr1>unassigned</AmazonElasticIPAddr1>
		<AmazonElasticModule1>unassigned</AmazonElasticModule1>
		<DataRedundancyConfig>n</DataRedundancyConfig>
		<DataRedundancyCopies>0</DataRedundancyCopies>
		<DataRedundancyStorageType>unassigned</DataRedundancyStorageType>
		<CoreFileFlag>n</CoreFileFlag>
		<MySQLPort>3306</MySQLPort>
		<AmazonDeviceName>/dev/xvd</AmazonDeviceName>
		<LockFileDirectory>/var/lock/subsys</LockFileDirectory>
		<ProfileFile>/etc/profile.d/columnstoreAlias.sh</ProfileFile>
        <DataRedundancyNetworkType/>
	</Installation>
	<ExtentMap>
		<!--
		WARNING: these can only be changed on an empty system. Once any object has been allocated
		it cannot be changed!. Extent size is 8M rows.
		-->
		<FilesPerColumnPartition>4</FilesPerColumnPartition> <!-- should be multiple of DBRootCount -->
		<ExtentsPerSegmentFile>2</ExtentsPerSegmentFile>
		<BRM_UID>0x0</BRM_UID>
	</ExtentMap>
	<HashJoin>
		<MaxBuckets>128</MaxBuckets>
		<MaxElems>128K</MaxElems>  <!-- 128 buckets * 128K * 16 = 256 MB -->
		<FifoSizeLargeSide>64</FifoSizeLargeSide>
		<PmMaxMemorySmallSide>1G</PmMaxMemorySmallSide>
		<TotalUmMemory>100%</TotalUmMemory>
		<TotalPmUmMemory>100%</TotalPmUmMemory>
		<CPUniqueLimit>100</CPUniqueLimit>
		<AllowDiskBasedJoin>N</AllowDiskBasedJoin>
		<!-- Be careful modifying TempFilePath!  On start, ExeMgr deletes
			the entire directory and recreates it to make sure no
			files are left behind.
		<TempFilePath>/tmp/cs-diskjoin</TempFilePath>  -->
		<TempFileCompression>Y</TempFileCompression>
	</HashJoin>
	<JobList>
		<FlushInterval>16K</FlushInterval>
		<FifoSize>16</FifoSize>
		<RequestSize>1</RequestSize>  <!-- Number of extents per request, should be
			  less than MaxOutstandingRequests. Otherwise, default value 1 is used. -->
		<!--  ProcessorThreadsPerScan is the number of jobs issued to process
			  each extent.  The default is 16.  MaxOutstandingRequests is the size of
			  the window of work in terms of extents.  A value of 20 means there
			  is 20 extents worth of work for the PMs to process at any given time.
			  ProcessorThreadsPerScan * MaxOutstandingRequests should be at least
			  as many threads are available across all PMs.  -->
		<!-- <ProcessorThreadsPerScan>16</ProcessorThreadsPerScan> -->
		<!-- MaxOutstandingRequests is going to default to the num of cores available
			 across all performance modules * 4 divided by the ProcessorThreadsPerScan,
			 but will be lower bounded by 20 -->
		<!-- <MaxOutstandingRequests>20</MaxOutstandingRequests>  -->
		<ThreadPoolSize>100</ThreadPoolSize>
	</JobList>
	<TupleWSDL>
		<MaxSize>1M</MaxSize>                   <!-- Max size in bytes per bucket -->
		<InitialCapacity>1M</InitialCapacity>   <!-- Initial capacity per bucket -->
		<MaxBuckets>512</MaxBuckets>            <!-- Number of buckets -->
	</TupleWSDL>
	<RowAggregation>
               <!-- <RowAggrThreads>4</RowAggrThreads> --> <!-- Default value is the number of cores -->
		<!-- <RowAggrBuckets>32</RowAggrBuckets> --> <!-- Default value is number of cores * 4 -->
		<!-- <RowAggrRowGroupsPerThread>20</RowAggrRowGroupsPerThread> --> <!-- Default value is 20 -->
	</RowAggregation>
	<CrossEngineSupport>
		<Host>127.0.0.1</Host>
		<Port>3306</Port>
		<User>root</User>
		<Password/>
		<TLSCA/>
		<TLSClientCert/>
		<TLSClientKey/>
	</CrossEngineSupport>
	<QueryStats>
		<Enabled>N</Enabled>
	</QueryStats>
	<UserPriority>
		<Enabled>N</Enabled>
	</UserPriority>
	<NetworkCompression>
		<Enabled>Y</Enabled>
	</NetworkCompression>
	<QueryTele>
		<Host>127.0.0.1</Host>
		<Port>0</Port>
	</QueryTele>
    <StorageManager>
        <MaxSockets>30</MaxSockets>
        <Enabled>N</Enabled>
    </StorageManager>
    <DataRedundancyConfig>
        <DBRoot1PMs/>
    </DataRedundancyConfig>
</Columnstore>
